<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="search.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Bellefair" rel="stylesheet">

</head>

<body>
    <div class="Page">
        <div class="container">
            <span class="search" id="s">
                <img src="search-engine.svg" style="width: 10vw ;height:10vh;" onclick="searchWiki()"/>
            </span>
            <div id="textAndInput">
            <div class="text">Search any wikipedia Page</div>
            <div class="search-name"><input name="search-text" type="text" id="po"/></div>
            </div>
            <div id="results">
                
            </div>
        </div>
            
    </div>
</body>
<script type="text/javascript">
function searchWiki(){
    const input = document.getElementById("po")
    const term = input.value.trim()
    if(!term){
        console.log("Empty Search Term")
        return;
    }
localStorage.setItem("lastSearch" , term);
var url = "https://en.wikipedia.org/w/api.php?action=opensearch&search="+ encodeURIComponent(term) +"&format=json&origin=*";
fetch(url,{
    method: "GET",
    headers: {
        accept: "application/json",
    }
}).then((res)=>res.json()).then((data)=>{
    console.log("API Results", data)
    const titles = data[1];
    const descriptions = data[2];
    const links = data[3];

    const resultsDiv = document.getElementById("results")
    resultsDiv.innerHTML = "";
    for(let i = 0; i<titles.length;i++){
        const item = document.createElement("div");
        item.className = "result-item";
        item.innerHTML = `
        <h3><a href = "${links[i]}" target="_blank" rel = "noopener noreferrer">
        ${titles[i]}
        </a></h3>
        <p>${descriptions[i]}</p>
        `
        resultsDiv.appendChild(item)
    }
})
    .catch((err)=>{
        console.log("Fetch Error", err)
    })
}
document.addEventListener("DOMContentLoaded", () => {
    const last = localStorage.getItem("lastSearch");
    if(last){
        document.getElementById("po").value = last
    }
})

</script>

</html>
